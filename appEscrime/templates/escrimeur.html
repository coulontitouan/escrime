{% extends 'base.html' %}

{% block styles %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename = 'escrimeur.css') }}" />
{% endblock %}

{% block content %}
<a id="retour" href="{{ url_for('affiche_competition', id_compet = competition.id) }}"><button
    class="btn btn-outline-secondary">Retour à la compétition : {{competition.nom}} </button></a>
<div class="escrimeur-info">
  <h2>Informations sur {{ escrimeur.prenom if competition.est_individuelle else "Équipe de" }} {{ escrimeur.nom }}</h2>
  {% if competition.est_individuelle %}
    <p>
      <strong>Date de naissance:</strong> {{ escrimeur.date_naissance.strftime(to_date) }}
    </p>
    <p>
      <strong>Numéro de licence:</strong> {{ escrimeur.num_licence }}
    </p>
  {% else %}
    <p>
      <strong>Membres de l'équipe:</strong>
    </p>
    <ul>
      {% for escrimeur in rq.get_membres_equipe(competition.id,escrimeur.num_licence) %}
        <li>
          {{ escrimeur.prenom }} {{ escrimeur.nom }}<br>
          Numéro de licence : {{ escrimeur.num_licence }}
        </li>
      {% endfor %}
    </ul>
  {% endif %}
  <p>
    <strong>Club:</strong> {{ escrimeur.get_club() }}
  </p>
  <p>
    <strong>Sexe:</strong> {{ escrimeur.get_sexe() }}
  </p>
</div>
<div class="competition-info">
  <h2>Informations sur la compétition</h2>
  <p>
    <strong>Nom:</strong> {{ competition.nom }}
  </p>
  <p>
    <strong>Date:</strong> {{ competition.date.strftime(to_date) }}
  </p>
  <table id="recap">
    <thead>
      <tr>
        <th colspan="100%">Récapitulatif des matchs</th>
      </tr>
      <tr>
        <th>Résultats</th>
        <th>Matchs</th>
        <th>Phase</th>
        <th>Scores</th>
        <th>Adversaires</th>
      </tr>
    </thead>
    <tbody>
      {% for participation in escrimeur.get_info_participation(competition.id) %}
      {% with id_match = participation.id_match %}
      <tr>
        <td>{{ participation.statut }}</td>
        <td>{{ participation.id_match }}</td>
        {% if not competition.est_cloturee %}
        <td><a href="{{ url_for('affiche_poule', id_compet = competition.id, id_poule = participation.get_phase().id) }}">
        {% else %}
        <td>
        {% endif %}
        {% if participation.get_phase().libelle == 'Poule' %}
        {{ participation.get_phase().libelle }} {{ participation.get_phase().id }}
        {% else %}
        {{ participation.get_phase().libelle }}
        {% endif %}
        </a>
        </td>
        <td>{{ participation.touches }} - {{ competition.get_participation(escrimeur.num_licence,
          participation.get_phase().id, id_match).touches }}
        </td>
        <td><a
            href="{{ url_for('affiche_escrimeur', id_escrimeur = participation.get_concurrent().num_licence, id_competition = competition.id) }}">
            {{ participation.get_concurrent().prenom if competition.est_individuelle else "Équipe de" }} {{ participation.get_concurrent().nom }}</a></td>
      </tr>
      {% endwith %}
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}